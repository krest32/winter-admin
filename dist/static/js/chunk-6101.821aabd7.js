(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6101"],{Az6A:function(e,t,o){"use strict";o.r(t);var i=o("s6q/"),a={inject:["reload"],data:function(){return{fileList:[],saveBtnDisabled:!1,BASE_API:"https://easy-mock.com/mock/5950a2419adc231f356a6636/vue-admin",catelogList:[],vedioInfo:{albumId:"",pictureAddress:"../static/cover.jpg",videoSourceId:"",videoOriginalName:"",size:0},albumList:[]}},created:function(){this.init()},methods:{handleAvatarSuccess:function(e,t){console.log(e),console.log(URL.createObjectURL(t.raw)),this.vedioInfo.pictureAddress=e.data.url,this.vedioInfo.pictureName=e.data.filename},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,o=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),o||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&o},init:function(){if(this.$route.params&&this.$route.params.id){var e=this.$route.params.id;this.getVedio(e),this.listCateLog(),this.listAlbum()}else this.listCateLog()},listAlbum:function(){var e=this;i.a.listAlbum().then(function(t){e.albumList=t.data.albumList})},getVedio:function(e){var t=this;i.a.getVedio(e).then(function(e){t.vedioInfo=e.data.vedio,console.log("vedioInfo:",t.vedioInfo),t.fileList=[{name:t.vedioInfo.videoOriginalName}]})},catelogChanged:function(e){for(var t=0;t<this.catelogList.length;t++)this.catelogList[t].id===e&&(this.albumList=this.catelogList[t].albumList,this.vedioInfo.albumId="")},addVedio:function(){var e=this;i.a.addVedio(this.vedioInfo).then(function(t){e.$message({type:"success",message:"保存成功!"})})},listCateLog:function(){var e=this;i.a.listCateLog().then(function(t){e.catelogList=t.data.list,console.log("catelogList:",e.catelogList)})},changeRoute:function(){this.$router.push({path:"/vedio/vedioList"})},updateVedio:function(){var e=this;i.a.updateVedio(this.vedioInfo).then(function(t){e.$message({type:"success",message:"更新成功!"})})},saveOrUpdate:function(){this.$route.params&&this.$route.params.id?(console.log("更新vedioInfo:",this.vedioInfo),this.updateVedio(),this.changeRoute()):(console.log("保存vedioInfo:",this.vedioInfo),this.addVedio(),this.changeRoute())},beforeVodRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},handleVodRemove:function(e,t){var o=this;console.log(e),i.a.removeVedioSourceId(this.vedioInfo.videoSourceId).then(function(e){o.vedioInfo.videoSourceId="",o.vedioInfo.videoOriginalName="",o.vedioInfo.size=console.log(o.vedioInfo),o.$message({type:"success",message:e.message})})},handleVodUploadSuccess:function(e,t,o){console.log("file:",t),this.vedioInfo.size=t.size,this.vedioInfo.videoSourceId=e.data.videoId,this.vedioInfo.videoOriginalName=t.name},handleUploadExceed:function(e,t){this.$message.warning("想要重新上传视频，请先删除已上传的视频")}}},d=(o("f8Vw"),o("KHd+")),n=Object(d.a)(a,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app-container"},[o("h1",[e._v("添加视频")]),e._v(" "),o("el-form",{attrs:{"label-width":"120px"}},[o("el-form-item",{attrs:{label:"标题"}},[o("el-input",{staticStyle:{width:"240px"},model:{value:e.vedioInfo.title,callback:function(t){e.$set(e.vedioInfo,"title",t)},expression:"vedioInfo.title"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"价格"}},[o("el-input-number",{staticStyle:{width:"240px"},attrs:{min:0},model:{value:e.vedioInfo.price,callback:function(t){e.$set(e.vedioInfo,"price",t)},expression:"vedioInfo.price"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"分类"}},[o("el-select",{staticStyle:{width:"240px"},attrs:{placeholder:"分类选择"},on:{change:e.catelogChanged},model:{value:e.vedioInfo.catelogId,callback:function(t){e.$set(e.vedioInfo,"catelogId",t)},expression:"vedioInfo.catelogId"}},e._l(e.catelogList,function(e){return o("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),e._v(" "),o("el-select",{staticStyle:{width:"240px"},attrs:{placeholder:"专辑选择"},model:{value:e.vedioInfo.albumId,callback:function(t){e.$set(e.vedioInfo,"albumId",t)},expression:"vedioInfo.albumId"}},e._l(e.albumList,function(e){return o("el-option",{key:e.title,attrs:{label:e.title,value:e.id}})}))],1),e._v("、\n\n    "),e._v(" "),o("el-form-item",{attrs:{label:"封面上传"}},[o("el-upload",{staticClass:"avatar-uploader",attrs:{"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload,action:e.BASE_API+"/others/Aliyun/oss"}},[o("img",{staticStyle:{width:"500px"},attrs:{src:e.vedioInfo.pictureAddress}})])],1),e._v(" "),o("el-form",{attrs:{"label-width":"120px"}},[o("el-form-item",{attrs:{label:"上传视频"}},[o("el-upload",{staticClass:"upload-demo",attrs:{"on-success":e.handleVodUploadSuccess,"on-remove":e.handleVodRemove,"before-remove":e.beforeVodRemove,"on-exceed":e.handleUploadExceed,"file-list":e.fileList,action:e.BASE_API+"/others/Aliyun/uploadvideo",limit:1}},[o("el-button",{attrs:{size:"small",type:"primary"}},[e._v("上传视频")]),e._v(" "),o("el-tooltip",{attrs:{placement:"right-end"}},[o("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n              最大支持1G，"),o("br"),e._v("\n              支持3GP、ASF、AVI、DAT、DV、FLV、F4V、"),o("br"),e._v("\n              GIF、M2T、M4V、MJ2、MJPEG、MKV、MOV、MP4、"),o("br"),e._v("\n              MPE、MPG、MPEG、MTS、OGG、QT、RM、RMVB、"),o("br"),e._v("\n              SWF、TS、VOB、WMV、WEBM 等视频格式上传\n            ")]),e._v(" "),o("i",{staticClass:"el-icon-question"})])],1)],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{disabled:e.saveBtnDisabled,type:"primary"},on:{click:e.saveOrUpdate}},[e._v("保存")])],1)],1)],1)],1)},[],!1,null,null,null);n.options.__file="editVedio.vue";t.default=n.exports},O6a5:function(e,t,o){},f8Vw:function(e,t,o){"use strict";var i=o("O6a5");o.n(i).a},"s6q/":function(e,t,o){"use strict";var i=o("t3Un");t.a={listCateLog:function(){return Object(i.a)({url:"/vedio/catelog/listCateLog",method:"get"})},addCateLog:function(e){return Object(i.a)({url:"/vedio/catelog/addCateLog",method:"post",data:e})},getCatelogById:function(e){return Object(i.a)({url:"/vedio/catelog/getCatelogById/"+e,method:"get"})},updateCatelog:function(e){return Object(i.a)({url:"/vedio/catelog/updateCatelog",method:"post",data:e})},deleteCatelog:function(e){return Object(i.a)({url:"/vedio/catelog/deleteCatelog/"+e,method:"delete"})},addAlbum:function(e){return Object(i.a)({url:"/vedio/album/addAlbum",method:"post",data:e})},pageQueryAlbum:function(e,t,o){return Object(i.a)({url:"/vedio/album/pageQueryAlbum/"+e+"/"+t,method:"post",data:o})},listAlbum:function(){return Object(i.a)({url:"/vedio/album/listAlbum",method:"get"})},deleteAlbum:function(e){return Object(i.a)({url:"/vedio/album/deleteAlbum/"+e,method:"delete"})},getAlbumById:function(e){return Object(i.a)({url:"/vedio/album/getAlbumById/"+e,method:"get"})},updateAlbumById:function(e){return Object(i.a)({url:"/vedio/album/updateAlbumById",method:"post",data:e})},querySearchVedio:function(e,t,o){return Object(i.a)({url:"/vedio/vedio/querySearchVedio/"+e+"/"+t,method:"post",data:o})},addVedio:function(e){return Object(i.a)({url:"/vedio/vedio/addVedio",method:"post",data:e})},removeVedioSourceId:function(e){return Object(i.a)({url:"/others/Aliyun/removeVedioById/"+e,method:"delete"})},getVedio:function(e){return Object(i.a)({url:"/vedio/vedio/getVedio/"+e,method:"get"})},updateVedio:function(e){return Object(i.a)({url:"/vedio/vedio/updateVedio",method:"post",data:e})},deleteVedio:function(e){return Object(i.a)({url:"/vedio/vedio/deleteVedio/"+e,method:"delete"})}}}}]);